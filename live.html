<!--ejecutar con "npx serve". Te generá una ip. Pulsa Ctrl+ClickIzq sobre la ip y luego "Open" entre las opciones del cuadro emergente para verlo en el browser-->
<!DOCTYPE html>
<html>
    <head>
        <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
        <script>
            AFRAME.registerComponent('hls_stream', {
                init: function(){
                    var video = document.getElementById('webcam_stream');
                    if(Hls.isSupported()) {
                    var hls = new Hls();
                    hls.loadSource('https://rbmn-live.akamaized.net/hls/live/590964/BoRB-AT/master_3360.m3u8');
                    hls.attachMedia(video);
                    hls.on(Hls.Events.MANIFEST_PARSED,function() {
                        video.play();
                    });
                }
                else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = 'https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8';
                    video.addEventListener('loadedmetadata',function() {
                        video.play();
                    });
                    }
                }
                
            })
            AFRAME.registerComponent('hls_stream_ii', {
                init: function(){
                    var video = document.getElementById('webcam_stream_ii');
                    if(Hls.isSupported()) {
                    var hls = new Hls();
                    hls.loadSource('https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8');
                    hls.attachMedia(video);
                    hls.on(Hls.Events.MANIFEST_PARSED,function() {
                        video.play();
                    });
                }
                else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = 'https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8';
                    video.addEventListener('loadedmetadata',function() {
                        video.play();
                    });
                    }
                }
            })
            AFRAME.registerComponent('youtube_stream', {
                init: function() {
                  var video = document.getElementById('youtube_stream_play');
                  var youtube_id = 'tfAWpOq8OPI'; //Reemplazar esta variable con el ID del vídeo en YouTube que quieres reproducir.
                  var youtube_url = 'https://www.youtube.com/watch?v=' + youtube_id;
        
                  if (Hls.isSupported()) {
                    var hls = new Hls();
                    hls.loadSource(youtube_url);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                      video.play();
                    });
                  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = youtube_url;
                    video.addEventListener('loadedmetadata', function() {
                      video.play();
                    });
                  }
                }
              });
          </script>
    </head>   
    <body>
        <a-scene cursor="rayOrigin:mouse">
            <a-assets>
                <video id="webcam_stream" autoplay playsinline muted loop="true" crossorigin="anonymous"></video> <!--asset del AFRAME.registerComponent('hls_stream'-->
                <video id="webcam_stream_ii" autoplay playsinline muted loop="true" crossorigin="anonymous"></video> <!--asset del AFRAME.registerComponent('hls_stream_ii'-->
                <video id="youtube_stream" autoplay playsinline muted loop="true" crossorigin="anonymous"></video> <!--asset del AFRAME.registerComponent('youtube_stream'-->
            </a-assets>

            <!--Reproductores 3D-->
            <a-sphere id= "principal-sphere" src="#webcam_stream" radius="-6" position="0 0 0" rotation="180 0 0" hls_stream></a-sphere>
            <!-- <a-plane src="#webcam_stream_ii" position="0 1.5 -4" rotation="0 0 0" width="2" height="1.5" hls_stream_ii></a-plane>
            <a-plane src="#webcam_stream" position="-3 1.5 -3" rotation="0 45 0" width="2" height="1.5"></a-plane>
            <a-plane src="#webcam_stream_ii" position="-4.5 1.5 0" rotation="0 90 0" width="2" height="1.5"></a-plane>
            <a-plane src="#youtube_stream_play" position="-3 1.5 3" rotation="0 135 0" width="2" height="1.5" youtube_stream></a-plane>
            <a-plane src="#webcam_stream_ii" position="0 1.5 4" rotation="0 180 0" width="2" height="1.5"></a-plane>
            <a-plane src="#webcam_stream" position="3 1.5 3" rotation="0 225 0" width="2" height="1.5"></a-plane>
            <a-plane src="#webcam_stream_ii" position="4.5 1.5 0" rotation="0 270 0" width="2" height="1.5"></a-plane>
            <a-plane src="#youtube_stream_play" position="3 1.5 -3" rotation="0 315 0" width="2" height="1.5"></a-plane> -->

          
            <!-- <a-entity id="camera"  wasd-controls camera look-controls></a-entity> -->
            <a-sky color="#111"></a-sky>
        </a-scene>
        <script>

            const sphere = document.getElementById("principal-sphere").entity;
function handleOrientation(event) {
    // With three.js
    let x = event.beta; // In degree in the range [-180,180)
    let y = event.gamma;
    let z = event.alpha;
    sphere.rotation.rotate(x,y,z);
}

window.addEventListener("deviceorientation", handleOrientation);

        </script>
    </body>
</html>